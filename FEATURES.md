# 🎵 语音变换应用功能说明

## 📖 项目概述

VoiceMorph 是一个基于 AI 技术的语音变换 Web 应用，支持多种音效处理和实时音频转换。用户可以通过录制或上传音频文件，应用各种音效，生成专业级的语音变换结果。

## 🏗️ 技术架构

### 后端技术栈
- **Node.js** - 服务器运行环境
- **Express.js** - Web 框架
- **SQLite** - 轻量级数据库
- **FFmpeg** - 专业音频处理引擎
- **JWT** - 用户认证令牌
- **bcrypt** - 密码加密

### 前端技术栈
- **HTML5** - 页面结构
- **CSS3** - 样式设计
- **JavaScript (ES6+)** - 交互逻辑
- **Web Audio API** - 音频录制和播放
- **Fetch API** - HTTP 请求

## 🎯 核心功能

### 1. 音频录制与上传
- **实时录制**: 支持浏览器麦克风实时录制
- **文件上传**: 支持 MP3, WAV, WEBM, OGG 格式
- **文件验证**: 自动验证文件类型和大小（最大 10MB）
- **音频可视化**: 实时显示音频波形

### 2. 音效处理引擎
支持 10 种专业音效：

| 音效名称 | 描述 | 技术实现 |
|---------|------|----------|
| 🤖 Robot Voice | 机器人声音 | 采样率转换 + 颤音效果 |
| 🐿️ Chipmunk | 花栗鼠高音 | 音调提升 + 速度调整 |
| 🎭 Deep Voice | 深沉低音 | 音调降低 + 速度调整 |
| 📢 Echo | 回声效果 | 延迟和混响处理 |
| ⏪ Reverse | 倒放音频 | 音频反向播放 |
| 📞 Phone Call | 电话音质 | 频段限制 + 音量增强 |
| 👽 Alien Voice | 外星人声音 | 多重效果组合 |
| 👹 Monster Voice | 怪物声音 | 低频处理 + 颤音 |
| 🤫 Whisper | 低语效果 | 音量降低 + 频段调整 |
| 📻 Radio Voice | 老式电台 | 频段限制 + 颤音效果 |

### 3. 用户认证系统
- **用户注册**: 用户名、邮箱、密码注册
- **用户登录**: JWT 令牌认证
- **密码安全**: bcrypt 加密存储
- **会话管理**: 自动登录状态保持
- **表单验证**: 前端和后端双重验证

### 4. 个人仪表板
- **录音历史**: 查看所有处理过的录音
- **元数据管理**: 显示时长、创建时间、播放次数
- **音频播放**: 内嵌播放器直接播放
- **操作管理**: 下载、分享、删除功能

### 5. 音频分享系统
- **分享链接**: 生成唯一分享链接
- **公开访问**: 无需登录即可访问分享内容
- **播放统计**: 记录分享内容的播放次数
- **社交分享**: 支持原生分享 API

## 📁 代码结构说明

### 后端文件

#### `server.js` - 主服务器
```javascript
// 主要功能：
- Express 服务器配置
- 路由定义和中间件设置
- 文件上传处理 (Multer)
- 音频处理 API 端点
- 用户认证集成
- 静态文件服务
```

#### `database.js` - 数据库层
```javascript
// 主要功能：
- SQLite 数据库连接管理
- 用户数据操作 (CRUD)
- 录音数据管理
- 分享链接生成
- 数据关系维护
```

#### `audio-processor.js` - 音频处理引擎
```javascript
// 主要功能：
- FFmpeg 音频处理集成
- 音效滤镜定义
- 音频格式转换
- 批量处理支持
- 音频信息提取
```

#### `auth.js` - 认证中间件
```javascript
// 主要功能：
- JWT 令牌生成和验证
- 密码加密和验证
- 用户认证中间件
- 速率限制保护
- 会话管理
```

### 前端文件

#### `public/js/app.js` - 主应用控制器
```javascript
// 主要功能：
- 应用初始化和配置
- 音频录制控制
- 音效选择处理
- 文件上传管理
- 结果展示和下载
- 用户界面状态管理
```

#### `public/js/audio.js` - 音频管理器
```javascript
// 主要功能：
- Web Audio API 集成
- 麦克风访问和录制
- 音频文件处理
- 音频可视化
- 播放控制
```

#### `public/js/auth.js` - 前端认证管理
```javascript
// 主要功能：
- 用户登录/注册界面
- 认证状态管理
- 个人资料显示
- 用户菜单控制
- 表单验证
```

#### `public/js/navigation.js` - 导航管理
```javascript
// 主要功能：
- 页面导航控制
- 模态框管理
- 平滑滚动
- 用户交互处理
```

#### `public/js/i18n.js` - 国际化支持
```javascript
// 主要功能：
- 多语言文本管理
- 动态语言切换
- 本地化支持
- 翻译文本更新
```

## 🔄 数据流程

### 1. 音频处理流程
```
用户操作 → 文件上传/录制 → 文件验证 → 音效选择 → 
FFmpeg 处理 → 结果生成 → 数据库存储 → 用户下载/分享
```

### 2. 用户认证流程
```
用户注册 → 密码加密 → 数据库存储 → JWT 生成 → 
前端存储 → 请求认证 → 权限验证 → 操作授权
```

### 3. 分享功能流程
```
录音完成 → 生成分享令牌 → 数据库记录 → 
分享链接生成 → 公开访问 → 播放统计更新
```

## 🛡️ 安全特性

### 1. 数据安全
- **密码加密**: bcrypt 哈希加密
- **JWT 认证**: 安全的令牌机制
- **SQL 注入防护**: 参数化查询
- **XSS 防护**: 输入验证和转义

### 2. 文件安全
- **文件类型验证**: 严格的文件格式检查
- **文件大小限制**: 防止大文件攻击
- **路径安全**: 防止目录遍历攻击
- **自动清理**: 定期清理临时文件

### 3. 网络安全
- **CORS 配置**: 跨域请求控制
- **Helmet 安全头**: HTTP 安全头部
- **速率限制**: 防止暴力攻击
- **会话安全**: 安全的会话配置

## 🌐 API 接口说明

### 认证接口
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出
- `GET /api/auth/profile` - 获取用户信息

### 音频处理接口
- `GET /api/effects` - 获取可用音效列表
- `POST /api/transform` - 音频转换处理
- `GET /api/download/:filename` - 下载处理后的音频

### 用户数据接口
- `GET /api/recordings` - 获取用户录音列表
- `POST /api/recordings/:id/share` - 分享录音
- `GET /api/share/:token` - 获取分享内容

## 🎨 用户界面特性

### 1. 响应式设计
- 支持桌面和移动设备
- 自适应布局
- 触摸友好的交互

### 2. 多语言支持
- 中文 (简体)
- English
- Español

### 3. 主题支持
- 浅色主题
- 深色主题
- 自动主题切换

### 4. 用户体验
- 实时进度显示
- 错误提示和成功反馈
- 加载状态指示
- 平滑动画效果

## 📊 性能优化

### 1. 前端优化
- 代码分割和懒加载
- 图片和资源压缩
- 浏览器缓存策略
- 异步操作处理

### 2. 后端优化
- 数据库连接池
- 音频处理异步化
- 文件流处理
- 内存使用优化

### 3. 服务器优化
- 静态文件 CDN
- Gzip 压缩
- 缓存策略
- 负载均衡

## 🔧 配置选项

### 环境变量
```env
PORT=3000                    # 服务器端口
NODE_ENV=production          # 运行环境
SESSION_SECRET=secret        # 会话密钥
JWT_SECRET=jwt-secret        # JWT 密钥
MAX_FILE_SIZE=10485760       # 最大文件大小
UPLOAD_DIR=./uploads         # 上传目录
```

### 音效配置
每个音效都可以通过修改 `audio-processor.js` 中的滤镜参数进行调整。

### 数据库配置
SQLite 数据库文件位置和连接参数可在 `database.js` 中配置。

## 🚀 扩展功能

### 1. 可扩展的音效系统
- 易于添加新音效
- 支持自定义滤镜参数
- 批量音效处理

### 2. 用户管理
- 用户权限系统
- 管理员功能
- 用户统计

### 3. 高级功能
- 音频格式转换
- 批量处理
- API 接口
- 第三方集成

## 📈 监控和日志

### 1. 应用监控
- 性能指标监控
- 错误日志记录
- 用户行为统计

### 2. 系统监控
- 服务器资源使用
- 数据库性能
- 文件系统监控

---

**这个语音变换应用提供了完整的音频处理解决方案，从用户界面到后端处理，都采用了现代化的技术栈和最佳实践。** 🎉
